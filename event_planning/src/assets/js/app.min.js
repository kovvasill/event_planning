!function(){"use strict";angular.module("app",["app.main","ngComponentRouter","ngResource"]).config(["$locationProvider",function(e){e.html5Mode({enabled:!0})}]).value("$routerRootComponent","appMain")}(),function(){"use strict";angular.module("app.main",["ui.bootstrap","app.events","app.about","app.login","app.cities"])}(),function(){"use strict";angular.module("app.login",[])}(),function(){"use strict";angular.module("app.about",[])}(),function(){"use strict";angular.module("app.cities",[])}(),function(){"use strict";angular.module("app.events",[]).component("events",{template:"<ng-outlet></ng-outlet>",$routeConfig:[{path:"/",name:"EventList",component:"eventList",useAsDefault:!0},{path:"/:id",name:"EventDetail",component:"eventDetail"}]})}(),function(){"use strict";function e(){var e=this;e.getYear=function(){var e=new Date;return e.getFullYear()}}angular.module("app.about").component("about",{templateUrl:"src/app/components/about/about.template.html",controller:e,$routeConfig:[{path:"/",name:"About",component:"about",useAsDefault:!0}]})}(),function(){"use strict";function e(e){var t=this;t.cities=e.query()}angular.module("app.cities").component("cities",{templateUrl:"src/app/components/cities/cities.template.html",controller:e,$routeConfig:[{path:"/",name:"Cities",component:"cities",useAsDefault:!0}]}),e.$inject=["CitiesService"]}(),function(){"use strict";function e(e,t,n){var r=this;t.initUsers().then(function(){},function(e){}),r.errorText="",r.userID="",r.password="",r.logedInUser=n,r.logInUser=function(){e.stringIsEmpty(r.userID)?r.errorText="User ID is required":t.logInUser(r.userID,r.password)?this.$router.navigate(["Events"]):r.errorText="User ID or password is incorrect"},r.logOutUser=function(){t.logOutUser()}}angular.module("app.login").component("login",{templateUrl:"src/app/components/login/login.template.html",bindings:{$router:"<"},controller:e,$routeConfig:[{path:"/",name:"Login",component:"login",useAsDefault:!0}]}),e.$inject=["UtilityService","UsersService","logedInUser"]}(),function(){"use strict";function e(e){var t=this;t.isUserLoggedIn=e.isUserLoggedIn,t.getUserFullName=e.getUserFullName}angular.module("app.main").component("appMain",{templateUrl:"/src/app/components/main/main.template.html",controller:e,$routeConfig:[{path:"/events/...",name:"Events",component:"events",useAsDefault:!0},{path:"/events/:id",name:"EventDetail",component:"eventDetail"},{path:"/about/...",name:"About",component:"about"},{path:"/cities/...",name:"Cities",component:"cities"},{path:"/login/...",name:"Login",component:"login"},{path:"/heroes/...",name:"Heroes",component:"heroes"}]}),e.$inject=["UsersService"]}(),function(){"use strict";angular.module("app").factory("CitiesService",["$resource",function(e){return e("http://localhost:36275/api/cities",{},{query:{method:"GET",params:{},isArray:!0}})}])}(),function(){"use strict";angular.module("app").constant("uniqueKeyIDs",{userKeyID:4,eventKeyID:4}),angular.module("app").value("logedInUser",{keyID:0,userID:"",password:"",firstName:"",lastName:"",age:0}),angular.module("app").factory("UsersService",["$q","$http","$rootScope","UtilityService","logedInUser","uniqueKeyIDs",function(e,t,n,r,s,o){var a={},i=parseInt(r.getLocalStorage("USER_UNIQUE_KEY_ID"));i||(i=o.userKeyID);var u=function(){return a.users},c=function(e){a=e},l=function(e){e.keyID=i,i++,a.users.push(e)},p=function(){r.setLocalStorage("USER_UNIQUE_KEY_ID",i),r.setLocalStorage("USERS",angular.toJson(a))},m=function(){var s=e.defer();if(n.usersWasInit)s.resolve("done");else{var o=angular.fromJson(r.getLocalStorage("USERS"));null!==o?(a=o,n.usersWasInit=!0,s.resolve("done")):t.get("src/assets/data/defaultUsers.json").success(function(e){c(e),n.usersWasInit=!0,s.resolve("done")}).error(function(e){s.reject(e)})}return s.promise},v=function(e,t){var n=!1,r=u();if(r)for(var o=0,a=r.length;a>o;o++)if(r[o].userID===e&&r[o].password===t){s.keyID=r[o].keyID,s.userID=r[o].userID,s.password=r[o].password,s.firstName=r[o].firstName,s.lastName=r[o].lastName,s.age=r[o].age,n=!0;break}return n},f=function(){s.keyID=0,s.userID="",s.password="",s.firstName="",s.lastName="",s.age=0},g=function(){return!r.stringIsEmpty(s.userID)},d=function(){return s.firstName+" "+s.lastName},D={addUser:l,saveUsers:p,initUsers:m,logInUser:v,logOutUser:f,isUserLoggedIn:g,getUserFullName:d,getUsers:u};return D}]),angular.module("app").factory("EventsService",["$q","$http","$rootScope","UtilityService","uniqueKeyIDs",function(e,t,n,r,s){var o={},a=parseInt(r.getLocalStorage("EVENT_UNIQUE_KEY_ID"));a||(a=s.eventKeyID);var i=function(){return o.events},u=function(e){var t=null,n=i();if(n)for(var r=0,s=n.length;s>r;r++)if(n[r].keyID===e){t=n[r];break}return t},c=function(e){o=e},l=function(e){e.keyID=a,a++,o.events.push(e)},p=function(){r.setLocalStorage("EVENT_UNIQUE_KEY_ID",a),r.setLocalStorage("EVENTS",angular.toJson(o))},m=function(){var s=e.defer();if(n.eventsWasInit)s.resolve("done");else{var a=angular.fromJson(r.getLocalStorage("EVENTS"));null!==a?(o=a,n.eventsWasInit=!0,s.resolve("done")):t.get("src/assets/data/defaultEvents.json").success(function(e){c(e),n.eventsWasInit=!0,s.resolve("done")}).error(function(e){s.reject(e)})}return s.promise},v={getEvents:i,getEventByKeyID:u,addEvent:l,saveEvents:p,initEvents:m};return v}])}(),function(){"use strict";angular.module("app").factory("UtilityService",function(){function e(e){return"ev_pl_"+e}function t(t){return localStorage.getItem(e(t))}function n(t,n){return localStorage.setItem(e(t),n)}function r(e){return!e||/^\s*$/.test(e)||0===e.length||!e.trim()}var s=function(e){return!e||0===Object.keys(e).length},o={getLocalStorage:t,setLocalStorage:n,stringIsEmpty:r,objIsEmpty:s};return o})}(),function(){"use strict";function e(e,t,n){var r=this;r.errorText="",r.evtName="",r.evtDate=new Date,r.evtDate.setHours(r.evtDate.getHours()+2),r.evtDate.setSeconds(0),r.evtDate.setMilliseconds(0),r.evtDescription="",r.evtPrice=0,r.btnText="Save",r.countInvitedUsers=0,n.initUsers();var s;this.$routerOnActivate=function(t){if(s=t.params.id,s>0){var n=e.getEventByKeyID(s);n&&(r.evtName=n.name,r.evtDate=new Date(n.date),r.evtDate.setSeconds(0),r.evtDate.setMilliseconds(0),r.evtDescription=n.description,r.evtPrice=n.price,r.btnText="Update")}},r.save=function(){if(t.stringIsEmpty(r.evtName))r.errorText="Name is required";else if(new Date(r.evtDate)<=new Date)r.errorText="Please set date in future";else if(s>0){var n=e.getEventByKeyID(s);n.name=r.evtName,n.date=r.evtDate,n.description=r.evtDescription,n.price=r.evtPrice,e.saveEvents(),this.$router.navigate(["EventList"])}else e.addEvent({name:r.evtName,date:r.evtDate,description:r.evtDescription,price:r.evtPrice,owner:1001,rate:3}),e.saveEvents(),this.$router.navigate(["EventList"])},r.usrs=null,r.getInvitedUsers=function(){if(t.objIsEmpty(r.usrs)&&(r.usrs=n.getUsers(),!t.objIsEmpty(r.usrs)))for(var e=0,s=r.usrs.length;s>e;e++)r.usrs[e].selected=!1;return r.usrs},r.inviteUsers=function(){if(r.countInvitedUsers=0,!t.objIsEmpty(r.usrs))for(var e=0,n=r.usrs.length;n>e;e++)r.usrs[e].selected&&r.countInvitedUsers++},r.getCountOfInvitedUsers=function(){return r.countInvitedUsers}}angular.module("app.events").component("eventDetail",{templateUrl:"src/app/components/events/eventDetail/eventDetail.template.html",bindings:{$router:"<"},controller:e}),e.$inject=["EventsService","UtilityService","UsersService"]}(),function(){"use strict";function e(e,t,n){var r=this;e.initEvents().then(function(){},function(e){}),r.getEvents=e.getEvents,r.eventClosed=function(e){var n=t(new Date,"d/M/yyyy h:mm:ss"),r=t(new Date(e),"d/M/yyyy h:mm:ss"),s=moment(r,"DD/MM/YYYY HH:mm:ss").diff(moment(n,"DD/MM/YYYY HH:mm:ss"));return 0>s},r.isUserLoggedIn=n.isUserLoggedIn}angular.module("app.events").component("eventList",{templateUrl:"src/app/components/events/eventList/eventList.template.html",controller:e}),e.$inject=["EventsService","dateFilter","UsersService"]}(),function(){"use strict";function e(){}angular.module("app").component("alertBar",{templateUrl:"src/app/shared/directives/alertBar/alertBarView.html",controller:e,bindings:{alertMsg:"<"}})}(),function(){"use strict";angular.module("app").directive("timeToLeft",["$interval","dateFilter",function(e,t){return{restrict:"A",templateUrl:"src/app/shared/directives/timeToLeft/timeToLeftView.html",link:function(n,r,s){function o(){if(a){var e=t(new Date,"d/M/yyyy h:mm:ss"),r=t(new Date(a),"d/M/yyyy h:mm:ss"),s=moment(r,"DD/MM/YYYY HH:mm:ss").diff(moment(e,"DD/MM/YYYY HH:mm:ss")),o="";if(s>0){var i=moment.duration(s);o=Math.floor(i.asHours())+moment.utc(s).format(":mm:ss"),i.asHours()<=4&&(n.soonEvt=!0)}n.ttLeft=o}}var a,i;n.ttLeft="",n.soonEvt=!1,n.$watch(s.timeToLeft,function(e){a=e,o()}),i=e(o,3e3),r.on("$destroy",function(){e.cancel(i)})}}}])}();