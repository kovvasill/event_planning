!function(){"use strict";angular.module("evtOrgCtrls").controller("BaseCtrl",["$scope","UtilityService","EventsService","UsersService",function(e,t,r,n){e.LocateTo=t.LocateTo,e.GetEvents=r.GetEvents,e.IsUserLoggedIn=n.IsUserLoggedIn,e.GetUserFullName=n.GetUserFullName}])}(),angular.module("evtOrgCtrls",[]),angular.module("evtOrgApp",["ngRoute","ngResource","evtOrgCtrls"]),function(){"use strict";angular.module("evtOrgApp").config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|ghttps?|ms-appx|x-wmapp0):/),e.imgSrcSanitizationWhitelist(/^\s*(https?|ftp|file|ms-appx|x-wmapp0):|data:image\//)}])}(),function(){"use strict";angular.module("evtOrgApp").config(["$routeProvider",function(e){e.when("/login",{templateUrl:"src/app/components/login/loginView.html",controller:"LoginCtrl"}).when("/home",{templateUrl:"src/app/components/home/homeView.html",controller:"HomeCtrl"}).when("/about",{templateUrl:"src/app/components/about/aboutView.html",controller:"AboutCtrl"}).when("/event",{templateUrl:"src/app/components/event/eventView.html",controller:"EventCtrl"}).when("/event/:keyID",{templateUrl:"src/app/components/event/eventView.html",controller:"EventCtrl"}).when("/cities",{templateUrl:"src/app/components/cities/citiesView.html",controller:"CitiesCtrl"}).otherwise({redirectTo:"/home"})}]),angular.module("evtOrgApp").run(["$rootScope","EventsService","UsersService",function(e,t,r){e.$on("$routeChangeStart",function(n,o,s){e.routeRedirected||(e.routeRedirected=!0,t.InitEvents().then(function(){},function(e){}),r.InitUsers().then(function(){},function(e){}))})}])}(),function(){"use strict";angular.module("evtOrgCtrls").controller("AboutCtrl",["$scope",function(e){e.GetYear=function(){var e=new Date;return e.getFullYear()}}])}(),function(){"use strict";angular.module("evtOrgCtrls").controller("CitiesCtrl",["$scope","CitiesService",function(e,t){e.Cities=t.query()}])}(),function(){"use strict";angular.module("evtOrgCtrls").controller("EventCtrl",["$scope","$routeParams","EventsService","UtilityService",function(e,t,r,n){if(e.errorText="",e.evtName="",e.evtDate=new Date,e.evtDate.setHours(e.evtDate.getHours()+2),e.evtDate.setSeconds(0),e.evtDate.setMilliseconds(0),e.evtDescription="",e.evtPrice=0,e.btnText="Save",t.keyID>0){var o=r.GetEventByKeyID(t.keyID);o&&(e.evtName=o.name,e.evtDate=new Date(o.date),e.evtDate.setSeconds(0),e.evtDate.setMilliseconds(0),e.evtDescription=o.description,e.evtPrice=o.price,e.btnText="Update")}e.Save=function(){if(n.StringIsEmpty(e.evtName))e.errorText="Name is required";else if(new Date(e.evtDate)<=new Date)e.errorText="Please set date in future";else if(t.keyID>0){var o=r.GetEventByKeyID(t.keyID);o.name=e.evtName,o.date=e.evtDate,o.description=e.evtDescription,o.price=e.evtPrice,r.SaveEvents(),e.LocateTo("/home")}else r.AddEvent({name:e.evtName,date:e.evtDate,description:e.evtDescription,price:e.evtPrice,owner:1001,rate:3}),r.SaveEvents(),e.LocateTo("/home")}}])}(),function(){"use strict";angular.module("evtOrgCtrls").controller("HomeCtrl",["$scope",function(e){e.IsEventsFiltering=function(){}}])}(),function(){"use strict";angular.module("evtOrgCtrls").controller("LoginCtrl",["$scope","UtilityService","UsersService",function(e,t,r){e.errorText="",e.userID="",e.password="",e.LogInUser=function(){t.StringIsEmpty(e.userID)?e.errorText="User ID is required":r.LogInUser(e.userID,e.password)?e.LocateTo("/home"):e.errorText="User ID or password is incorrect"}}])}(),function(){"use strict";angular.module("evtOrgApp").factory("CitiesService",["$resource",function(e){return e("http://localhost:36275/api/cities",{},{query:{method:"GET",params:{},isArray:!0}})}])}(),function(){"use strict";angular.module("evtOrgApp").constant("uniqueKeyIDs",{userKeyID:4,eventKeyID:4}),angular.module("evtOrgApp").value("logedInUser",{keyID:0,userID:"",password:"",firstName:"",lastName:"",age:0}),angular.module("evtOrgApp").factory("UsersService",["$q","$http","$rootScope","UtilityService","logedInUser","uniqueKeyIDs",function(e,t,r,n,o,s){var a={},i=parseInt(n.GetLocalStorage("USER_UNIQUE_KEY_ID"));i||(i=s.userKeyID);var c=function(){return a.users},u=function(e){a=e},l=function(e){e.keyID=i,i++,a.users.push(e)},v=function(){n.SetLocalStorage("USER_UNIQUE_KEY_ID",i),n.SetLocalStorage("USERS",angular.toJson(a))},m=function(){var o=e.defer();if(r.usersWasInit)o.resolve("done");else{var s=angular.fromJson(n.GetLocalStorage("USERS"));null!=s?(a=s,r.usersWasInit=!0,o.resolve("done")):t.get("src/assets/data/defaultUsers.json").success(function(e){u(e),r.usersWasInit=!0,o.resolve("done")}).error(function(e){o.reject(e)})}return o.promise},f=function(e,t){for(var r=!1,n=0,s=c().length;s>n;n++)if(c()[n].userID===e&&c()[n].password===t){o.keyID=c()[n].keyID,o.userID=c()[n].userID,o.password=c()[n].password,o.firstName=c()[n].firstName,o.lastName=c()[n].lastName,o.age=c()[n].age,r=!0;break}return r},p=function(){return!n.StringIsEmpty(o.userID)},g=function(){return o.firstName+" "+o.lastName};return{AddUser:l,SaveUsers:v,InitUsers:m,LogInUser:f,IsUserLoggedIn:p,GetUserFullName:g}}]),angular.module("evtOrgApp").factory("EventsService",["$q","$http","$rootScope","UtilityService","uniqueKeyIDs",function(e,t,r,n,o){var s={},a=parseInt(n.GetLocalStorage("EVENT_UNIQUE_KEY_ID"));a||(a=o.eventKeyID);var i=function(){return s.events},c=function(e){for(var t=null,r=0,n=i().length;n>r;r++)if(i()[r].keyID==e){t=i()[r];break}return t},u=function(e){s=e},l=function(e){e.keyID=a,a++,s.events.push(e)},v=function(){n.SetLocalStorage("EVENT_UNIQUE_KEY_ID",a),n.SetLocalStorage("EVENTS",angular.toJson(s))},m=function(){var o=e.defer();if(r.eventsWasInit)o.resolve("done");else{var a=angular.fromJson(n.GetLocalStorage("EVENTS"));null!=a?(s=a,r.eventsWasInit=!0,o.resolve("done")):t.get("src/assets/data/defaultEvents.json").success(function(e){u(e),r.eventsWasInit=!0,o.resolve("done")}).error(function(e){o.reject(e)})}return o.promise};return{GetEvents:i,GetEventByKeyID:c,AddEvent:l,SaveEvents:v,InitEvents:m}}])}(),function(){"use strict";angular.module("evtOrgApp").factory("UtilityService",["$location",function(e){function t(e){return"ev_pl_"+e}function r(e){return localStorage.getItem(t(e))}function n(e,r){return localStorage.setItem(t(e),r)}function o(e){return!e||/^\s*$/.test(e)||0===e.length||!e.trim()}var s=function(t){e.path(t)},a=function(e){return 0===Object.keys(e).length},i=function(e,t,r,n){var o=i.canvas||(i.canvas=document.createElement("canvas")),s=o.getContext("2d");s.font=t;var a=s.measureText(e),c=a.width+IE_TXT_EXTRA_SPACE;return r>c?c=r:c>n&&(c=n),c},c=function(e){if(""!=e){var t=new Date(e),r=t.getUTCFullYear().toString(),n=(t.getUTCMonth()+1).toString(),o=t.getUTCDate().toString(),s=(o[1]?o:"0"+o[0])+"-"+(n[1]?n:"0"+n[0])+"-"+r,a=t.getUTCHours().toString();n=t.getUTCMinutes().toString();var i=(a[1]?a:"0"+a[0])+":"+(n[1]?n:"0"+n[0]);return s+" "+i}return""};return{LocateTo:s,GetLocalStorage:r,SetLocalStorage:n,StringIsEmpty:o,ObjIsEmpty:a,GetTextWidth:i,GetFormatedDateTime:c}}])}(),function(){"use strict";angular.module("evtOrgCtrls").directive("alertBar",["$compile",function(e){return{restrict:"E",scope:{alertMsg:"@alertMsg"},templateUrl:"src/app/shared/directives/alertBar/alertBarView.html"}}])}(),function(){"use strict";angular.module("evtOrgCtrls").directive("timeToLeft",["$interval","dateFilter",function(e,t){return{restrict:"A",templateUrl:"src/app/shared/directives/timeToLeft/timeToLeftView.html",link:function(r,n,o){function s(){if(a){var e=t(new Date,"d/M/yyyy h:mm:ss"),n=t(new Date(a),"d/M/yyyy h:mm:ss"),o=moment(n,"DD/MM/YYYY HH:mm:ss").diff(moment(e,"DD/MM/YYYY HH:mm:ss")),s="";if(o>0){var i=moment.duration(o);s=Math.floor(i.asHours())+moment.utc(o).format(":mm:ss"),i.asHours()<=4&&(r.soonEvt=!0)}r.ttLeft=s}}var a,i;r.ttLeft="",r.soonEvt=!1,r.$watch(o.timeToLeft,function(e){a=e,s()}),i=e(s,3e3),n.on("$destroy",function(){e.cancel(i)})}}}])}();